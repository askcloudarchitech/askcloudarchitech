{{ define "main" }}
{{ partial "page-header" . }}
{{ range (.Paginate .RegularPagesRecursive).Pages }}
        {{ $source := "" }}
        {{ if .Params.MainImage }}
            {{ $source = (.Resources.ByType "image").GetMatch (.Params.MainImage) }}
        {{ else }}
            {{ $source = resources.Get "logo-transparent.png"}}
        {{ end }}

        {{ $source = $source.Resize "600x" }}
        <article class="gdoc-markdown gdoc-post">
            <header class="gdoc-post__header">
                <h1 class="gdoc-post__title"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h1>
            </header>
            <div class="summary-flex">
                <div class="summary-image"> <a href="{{ .RelPermalink }}"><img src="{{ $source.RelPermalink }}" alt="{{ $source.Title }}" /></a></div>
                <section>
                    {{ .Summary }}
                </section>
            </div>
            <div class="gdoc-post__readmore">
                {{ if .Truncated }}
                <a class="flex-inline align-center fake-link" title="Read full post" href="{{ .RelPermalink }}">Read full post</a>
                {{ end }}
            </div>

            <footer class="gdoc-post__footer">
                <span class="no-wrap">
                    <svg class="icon gdoc_date"><use xlink:href="#gdoc_date"></use></svg>
                    <span class="gdoc-post__tag">
                        <time datetime="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" | safeHTML }}">
                            {{ if .Lastmod.After (.Date.AddDate 0 0 1) }}
                                Updated on
                            {{ end }}
                            {{ .Lastmod.Format "Jan 2, 2006" }}
                        </time>
                    </span>
                </span>

                <span class="no-wrap">
                    <svg class="icon gdoc_timer"><use xlink:href="#gdoc_timer"></use></svg>
                    <span class="gdoc-post__tag">{{ .ReadingTime }} min read</span>
                </span>
            </footer>
        </article>
    {{ end }}
    {{ template "_internal/pagination.html" . }}
{{ end }}

{{ define "post-tag" }}
<span class="gdoc-post__tag">
    <span class="gdoc-button">
        <a class="gdoc-button__link" href="{{ .page.RelPermalink }}" title="All posts tagged with '{{ .name }}'">{{ .name }}</a>
    </span>
</span>
{{ end }}
